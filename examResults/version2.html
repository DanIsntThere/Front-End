<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exam Results</title>
    <style>
      table,
      td {
        border: 1px solid black;
        padding: 5px;
        margin-bottom: 15px;
        text-align: center;
        font-size: 30px;
      }
      body {
        background-color: whitesmoke;
        color: rgb(94, 209, 251);
      }
      input {
        background-color: whitesmoke;
        color: rgb(94, 209, 251);
      }
    </style>
  </head>
  <body>
    <h1>Exam Results</h1>
    <p>All the questions are out of 5</p>
    <p>
      It's sort of like an alteranative to storing student exam results in
      spreadsheats but all the results will be lost once the page is refreshed
      so
    </p>
    <form id="myForm" onsubmit="return results();return false">
      <label for="q1">Student Firstname:</label><br />
      <input
        type="text"
        id="fname"
        name="fname"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <label for="q1">Student Lastname:</label><br />
      <input
        type="text"
        id="lname"
        name="lname"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <label for="q1">Question 1:</label><br />
      <input
        type="number"
        id="q1"
        min="0"
        max="5"
        name="q1"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <label for="q2">Question 2:</label><br />
      <input
        type="number"
        id="q2"
        min="0"
        max="5"
        name="q2"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <label for="q3">Question 3:</label><br />
      <input
        type="number"
        id="q3"
        min="0"
        max="5"
        name="q3"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <label for="q4">Question 4:</label><br />
      <input
        type="number"
        id="q4"
        min="0"
        max="5"
        name="q4"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <label for="q5">Question 5:</label><br />
      <input
        type="number"
        id="q5"
        min="0"
        max="5"
        name="q5"
        style="font-size: 20px; padding: 10px"
        required
      /><br /><br />
      <input
        type="button"
        value="Submit"
        onclick="results()"
        style="font-size: 20px; padding: 10px"
      />
    </form>
    <button type="button" onclick="CreateTextFile();">
      Export results to text file
    </button>

    <script>
      //import { saveAs } from 'file-saver';
      console.log("I forgot how to comment");
      console.log(
        "#The brief was not clear about what goes in the results table"
      );
      count = 0;
      function results() {
        //Creates table and headings
        if (count === 0) {
          var x = document.createElement("TABLE");
          x.setAttribute("id", "myTable");
          document.body.appendChild(x);

          var y = document.createElement("TR");
          y.setAttribute("id", "myTr");
          document.getElementById("myTable").appendChild(y);

          var z = document.createElement("TD");
          var t = document.createTextNode("Student Firstname");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Student Lastname");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Question 1");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Question 2");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Question 3");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Question 4");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Question 5");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Overall");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Average");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);

          var z = document.createElement("TD");
          var t = document.createTextNode("Grade");
          z.appendChild(t);
          document.getElementById("myTr").appendChild(z);
        }

        let a = document.forms["myForm"]["q1"].value;
        let b = document.forms["myForm"]["q2"].value;
        let c = document.forms["myForm"]["q3"].value;
        let d = document.forms["myForm"]["q4"].value;
        let e = document.forms["myForm"]["q5"].value;
        let f = document.forms["myForm"]["fname"].value;
        let g = document.forms["myForm"]["lname"].value;
        q1 = parseInt(a);
        q2 = parseInt(b);
        q3 = parseInt(c);
        q4 = parseInt(d);
        q5 = parseInt(e);

        ans = [q1, q2, q3, q4, q5];
        ans.forEach(iteration);

        overall = q1 + q2 + q3 + q4 + q5;
        avg = overall / 5;
        if (overall <= 0) {
          grade = "F";
        } else if (overall < 10) {
          grade = "D";
        } else if (overall < 15) {
          grade = "C";
        } else if (overall < 20) {
          grade = "B";
        } else if (overall < 25) {
          grade = "A";
        } else {
          grade = "A*";
        }
        ans.push(overall, avg, grade);
        ans.unshift(f, g);

        for (let i = 0; i < 1; i++) {
          var y = document.createElement("TR");
          y.setAttribute("id", count);
          document.getElementById("myTable").appendChild(y);

          for (let x = 0; x < 10; x++) {
            var z = document.createElement("TD");
            var t = document.createTextNode(ans[x]);
            z.appendChild(t);
            document.getElementById(count).appendChild(z);
          }
        }
      }

      function iteration(value) {
        if (isNaN(value)) {
          alert("You must enter a number between 0 and 5!");
          throw new Error("You must enter a number between 0 and 5!");
        } else if (value > 5) {
          alert("You must enter a number between 0 and 5!");
          throw new Error("You must enter a number between 0 and 5!");
        } else if (value < 0) {
          alert("You must enter a number between 0 and 5!");
          throw new Error("You must enter a number between 0 and 5!");
        } else if (value === NaN) {
          alert("You must enter a number between 0 and 5!");
          throw new Error("You must enter a number between 0 and 5!");
        }
        count = count + 1;
      }

      /**
      function CreateTextFile() {
         var blob = new Blob([ans], {
            type: "text/plain;charset=utf-8",
         });
         saveAs(blob, "results.txt");
      }
        **/
      function CreateTextFile() {
        const fs = require("fs");
        let fInput = ans;
        fs.writeFile("tp.txt", fInput, (err) => {
          if (err) throw err;
          else {
            console.log("The file is updated with the given data");
          }
        });
      }
    </script>
  </body>
</html>
